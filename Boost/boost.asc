Version 4
SHEET 1 1296 680
WIRE -128 -592 -256 -592
WIRE -16 -592 -48 -592
WIRE 128 -592 80 -592
WIRE 272 -592 208 -592
WIRE 320 -592 272 -592
WIRE 448 -592 384 -592
WIRE 272 -560 272 -592
WIRE -256 -480 -256 -592
WIRE -128 -480 -256 -480
WIRE 224 -480 -48 -480
WIRE 272 -448 272 -464
WIRE 752 -416 752 -448
WIRE -256 -368 -256 -480
WIRE -128 -368 -256 -368
WIRE 80 -368 80 -592
WIRE 80 -368 -48 -368
WIRE 128 -368 80 -368
WIRE 272 -368 208 -368
WIRE 320 -368 272 -368
WIRE 448 -368 448 -592
WIRE 448 -368 384 -368
WIRE 512 -368 448 -368
WIRE 592 -368 512 -368
WIRE 80 -352 80 -368
WIRE 272 -336 272 -368
WIRE 592 -336 592 -368
WIRE 448 -320 448 -368
WIRE 512 -320 512 -368
WIRE -256 -256 -256 -368
WIRE -128 -256 -256 -256
WIRE 224 -256 -48 -256
WIRE 80 -208 80 -288
WIRE 272 -208 272 -240
WIRE 272 -208 80 -208
WIRE 448 -208 448 -256
WIRE 448 -208 272 -208
WIRE 512 -208 512 -256
WIRE 512 -208 448 -208
WIRE -256 -160 -256 -256
WIRE 272 -160 272 -208
WIRE 592 -160 592 -256
WIRE 752 -160 752 -208
FLAG 272 -160 0
FLAG 592 -160 0
FLAG 272 -448 0
FLAG -256 -160 0
FLAG -16 -592 r
FLAG 592 -368 out
FLAG 752 -160 0
FLAG 752 -288 y
FLAG 752 -416 0
FLAG 752 -528 ref
SYMBOL ind 112 -352 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L1
SYMATTR Value 15µ
SYMATTR SpiceLine Ipk=8 Rser=26m
SYMBOL cap 64 -352 R0
SYMATTR InstName C1
SYMATTR Value 100µ
SYMBOL cap 432 -320 R0
SYMATTR InstName C2
SYMATTR Value 1m
SYMATTR SpiceLine V=35 Irms=1.8 Rser=35m
SYMBOL schottky 320 -352 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D1
SYMATTR Value MBRS340
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL res 576 -352 R0
SYMATTR InstName R1
SYMATTR Value 15
SYMBOL voltage -32 -368 R90
WINDOW 123 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value 3
SYMATTR SpiceLine Rser=10m
SYMBOL nmos 224 -336 R0
SYMATTR InstName M1
SYMATTR Value IRF7805ZPbF
SYMBOL voltage -32 -592 R90
WINDOW 3 22 285 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value PULSE(0 1 0 10u 10u 0 20u)
SYMBOL ind 112 -576 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 5 56 VBottom 2
SYMATTR InstName L2
SYMATTR Value 15µ
SYMATTR SpiceLine Ipk=8 Rser=26m
SYMBOL schottky 320 -576 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName D2
SYMATTR Value MBRS340
SYMATTR Description Diode
SYMATTR Type diode
SYMBOL nmos 224 -560 R0
SYMATTR InstName M2
SYMATTR Value IRF7805ZPbF
SYMBOL bv -32 -480 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B1
SYMATTR Value V=5*(V(r)<V(y))
SYMBOL bv -32 -256 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName B2
SYMATTR Value V=5*(V(r)>1-V(y))
SYMBOL bv 752 -304 R0
WINDOW 3 -164 208 Left 2
SYMATTR InstName B3
SYMATTR Value V=limit(0,{P}*(V(ref)-V(out)),0.95)
SYMBOL voltage 752 -544 R0
WINDOW 3 -235 333 Invisible 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value PWL(0 0 2m {ref})
SYMBOL cap 496 -320 R0
SYMATTR InstName C3
SYMATTR Value 1m
SYMATTR SpiceLine V=35 Irms=1.8 Rser=35m
TEXT -122 -112 Left 2 !.tran 10m
TEXT -120 -80 Left 2 !.param ref=12 P=10
